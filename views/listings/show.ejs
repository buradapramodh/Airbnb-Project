<link rel="stylesheet" href="/css/show.css">

<% layout("/layouts/boilerplate") %>

<!-- ================= MAP DATA ================= -->
<script>
  const mapToken = "<%= MAP_TOKEN %>";
  const listing = <%- JSON.stringify(listing) %>;
</script>

<div class="row mt-3 show-main">
  <div class="col-8 offset-2">

    <!-- ===== TITLE ===== -->
    <h3 class="mb-3"><%= listing.title %></h3>

    <!-- ===== IMAGE ===== -->
    <img
      src="<%= listing.image.url %>"
      class="img-fluid rounded mb-4"
      alt="listing image"
    />

    <!-- ===== DETAILS ===== -->
    <p><b>Location:</b> <%= listing.location %>, <%= listing.country %></p>
    <p>
      <b>Price:</b>
      ₹<%= listing.price.toLocaleString("en-IN") %> / night
    </p>

    <% if (listing.owner) { %>
      <p><b>Hosted by:</b> @<%= listing.owner.username %></p>
    <% } %>

    <% if (listing.description) { %>
      <p><b>Description:</b> <%= listing.description %></p>
    <% } %>

    <% if (listing.category && listing.category.length) { %>
      <p><b>Category:</b> <%= listing.category.join(", ") %></p>
    <% } %>

  </div>

  <!-- ===== MAP SECTION ===== -->
  <% if (listing.geometry && listing.geometry.coordinates) { %>
    <div class="col-8 offset-2 mt-4">
      <h5 class="mb-2">
        Where you’ll be <i class="fa-solid fa-location-dot"></i>
      </h5>

      <div
        id="map"
        style="height:400px; border-radius:12px;"
      ></div>
    </div>
  <% } else { %>
    <div class="col-8 offset-2 mt-4">
      <p class="text-danger">Location map not available</p>
    </div>
  <% } %>
</div>

<!-- ================= MAPBOX ================= -->
<script src="https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.js"></script>
<script src="/js/map.js"></script>
